<!DOCTYPE html>

<head>
    <title>MMU Bulletin</title>
    <link rel="stylesheet" href="css/materialize.min.css" media="screen,projection" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

<script src="js/TweenMax.min.js"></script>
<script src="js/ScrollToPlugin.min.js"></script>
    <link rel="stylesheet" href="css/style.css"/>
    <link rel="manifest" href="manifest.json">
        <script>
      // Service workers require HTTPS (http://goo.gl/lq4gCo). If we're running on a real web server
      // (as opposed to localhost on a custom port, which is whitelisted), then change the protocol to HTTPS.
      if ((!location.port || location.port == "80") && location.protocol != 'https:') {
        location.protocol = 'https:';
      }
    </script>
    
</head>

<body>
      <div class="navbar-fixed">
<nav>
    <a href="#" class="brand-logo">MMU Bulletin</a>
  <ul class="right hide-on-med-and-down">
    <li><a href="https://cms.mmu.edu.my/psp/csprd/?cmd=login&languageCd=ENG&">CamSys</a></li>
    <li><a href="//mmls.mmu.edu.my">MMLS</a></li>
    <li><a id="reload">limhenry.me</a></li>
  </ul>
  <ul id="slide-out" class="side-nav">
    <div id="nav-banner">
        <p>MMU Bulletin</p>
    </div>
    <li><a href="https://cms.mmu.edu.my/psp/csprd/?cmd=login&languageCd=ENG&">CamSys</a></li>
    <li><a href="//mmls.mmu.edu.my">MMLS</a></li>
    <li><a id="reload">limhenry.me</a></li>        
  </ul>
  <a href="#" data-activates="slide-out" class="button-collapse"><i class="mdi-navigation-menu"></i></a>
</nav>
</div>

    <ul class="collapsible" data-collapsible="accordion" id="links">

    </ul>

 <footer class="page-footer">
          <div class="container">
            <div class="row">
              <div class="col l6 s12">
                <h4 class="white-text">MMU Bulletin</h4>
                <p class="grey-text text-lighten-4">MMU Bulletin Board with Material Design.<br>Created and Designed by Henry Lim. API created by Hii.</p>
              </div>
              <div class="col l4 offset-l2 s12">
                <h5 class="white-text">limhenry</h5>
                <ul>
                  <li><a class="grey-text text-lighten-3" href="//limhenry.me">limhenry.me</a></li>
                  <li><a class="grey-text text-lighten-3" href="//blog.limhenry.me">Blog</a></li>
                  <li><a class="grey-text text-lighten-3" href="//github.com/limhenry">GitHub</a></li>
                  <li><a class="grey-text text-lighten-3" href="//plus.google.com/+HenryLim96">Google Plus</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="footer-copyright">
            <div class="container">
            Â© 2015 Henry Lim
            </div>
          </div>
        </footer>
            

    <script type="text/javascript" src="jquery-2.1.1.min.js"></script>
    <script src="js/materialize.min.js"></script>


<script>
    var i = 0;
    var getJSON = function(url) {
        return new Promise(function(resolve, reject) {
            var xhr = new XMLHttpRequest();
            xhr.open('get', url, true);
            xhr.responseType = 'json';
            xhr.onload = function() {
                var status = xhr.status;
                if (status == 200) {
                    resolve(xhr.response);
                } else {
                    reject(status);
                }
            };
            xhr.send();
        });
    };

    getJSON('//mmu-api.co/bulletin_api').then(function(data) {

            while (i < data.length) {
                var div = document.createElement("div");
                var div2 = document.createElement("div");
                var li = document.createElement("li");
                var p = document.createElement("p");
                li.setAttribute("id", i);
                var title = document.createTextNode(data[i].title.toUpperCase() + " - " + data[i].posted_date);

                if (data[i].contents.length > 5) {
                    var contents = document.createTextNode(data[i].contents);
                } else {
                    var contents = document.createTextNode("Move along, nothing to see here");
                }

                div.appendChild(title);
                div2.appendChild(p);
                p.appendChild(contents);

                div.setAttribute("class", "collapsible-header");
                div2.setAttribute("class", "collapsible-body");
                document.getElementById("links").appendChild(li);
                document.getElementById(i).appendChild(div);
                document.getElementById(i).appendChild(div2);
                p = document.getElementById(i).children[1].children[0]
                p.innerHTML = p.innerHTML.replace(/\n\n/g,"<br>")
                console.log("done")
                i++;
            }
            run();
        }

    );

    function run() {
        Materialize.toast('WARNING: This is an experimental build.', 5000); // 
        $('.collapsible').collapsible({
            accordion: false // A setting that changes the collapsible behavior to expandable instead of the default accordion style
        });

    }



</script>
<script>
 $(".button-collapse").sideNav();
</script>  
<script>
$(function(){   

        var $window = $(window);
    var scrollTime = 0.5;
    var scrollDistance = 230;

    $window.on("mousewheel DOMMouseScroll", function(event){

        event.preventDefault(); 

        var delta = event.originalEvent.wheelDelta/120 || -event.originalEvent.detail/3;
        var scrollTop = $window.scrollTop();
        var finalScroll = scrollTop - parseInt(delta*scrollDistance);

        TweenMax.to($window, scrollTime, {
            scrollTo : { y: finalScroll, autoKill:true },
                ease: Power1.easeOut,
                overwrite: 5                            
            });

    });
});
</script>
<script src='js/app.js'></script>
</body>
</html>